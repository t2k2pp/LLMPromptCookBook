# レシピ1-4: 段階的な指示の組み立て方

## 課題（Problem）
複雑な開発タスクをLLMに依頼する際、一度に全ての要件を伝えようとすると以下の問題が発生します：

- LLMが重要な要件を見落とす
- 生成される結果が部分的に不適切
- フィードバックが困難
- 修正コストの増大

## 解決方法（Solution）
タスクを段階的なステップに分解し、各段階で適切なフィードバックを得ながら進めます：

1. 要件の階層化と優先順位付け
2. 段階的な指示の提供
3. フィードバックループの確立
4. 反復的な改善

## プロンプトパターン

### 段階的な指示の基本構造

```
Phase 1: アーキテクチャ設計
要件:
1. システム構成の概要
2. 主要コンポーネントの定義
3. データフローの設計

評価基準:
- スケーラビリティ
- メンテナンス性
- 拡張性

---
Phase 2: インターフェース設計
要件:
1. APIエンドポイントの定義
2. データモデルの設計
3. バリデーションルール

評価基準:
- APIの一貫性
- 型安全性
- エラーハンドリング

---
Phase 3: 実装詳細
要件:
1. コアロジックの実装
2. エラー処理の実装
3. テストケースの作成

評価基準:
- コードの品質
- テストカバレッジ
- パフォーマンス
```

## 実践例：ECサイトの商品検索API実装

### Phase 1: 要件定義とアーキテクチャ設計

```
あなたは、大規模ECサイトのバックエンド開発を担当するシニアエンジニアです。
商品検索APIの実装について、段階的に設計と実装を進めていきたいと思います。

Phase 1の目標:
- 検索APIのアーキテクチャ設計
- 主要コンポーネントの特定
- データフローの定義

技術スタック:
- バックエンド: NestJS/TypeScript
- 検索エンジン: Elasticsearch
- キャッシュ: Redis
- データベース: PostgreSQL

要件:
1. 商品名、カテゴリ、価格による検索
2. ファセット検索のサポート
3. レスポンスタイム: 200ms以内

まずは、この要件に基づいたアーキテクチャ設計案を提示してください。
```