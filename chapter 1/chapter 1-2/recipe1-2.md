# レシピ1-2: コンテキストの効果的な提供方法

## 課題（Problem）
開発者がLLMに適切なコンテキストを提供できず、以下のような問題が発生しています：
- プロジェクトの制約に合わないコードが生成される
- 既存のコードベースとスタイルが不一致
- 必要な依存関係やライブラリが考慮されていない

## 解決方法（Solution）
コンテキストを階層的に構造化し、必要な情報を効率的に提供します：

1. プロジェクトレベルのコンテキスト
2. 技術スタックの詳細
3. タスク固有の要件
4. 制約条件と期待される結果

## プロンプト例

### 基本的なコンテキスト提供パターン

```
# プロジェクトコンテキスト
プロジェクト: ECサイトのバックエンド開発
フェーズ: 設計・実装フェーズ
チーム規模: 5名のバックエンドエンジニア

# 技術スタック
- 言語: TypeScript 5.0
- フレームワーク: NestJS 10.x
- データベース: PostgreSQL 15
- ORM: TypeORM 0.3.x
- テスト: Jest 29.x

# アーキテクチャ要件
- クリーンアーキテクチャベース
- ドメイン駆動設計（DDD）の原則に従う
- リポジトリパターンを採用

# コーディング規約
- ESLintの設定に従う
- インターフェースは'I'プレフィックスを使用
- サービスは'Service'サフィックスを使用
- 依存性注入を活用

# タスク固有の要件
注文処理サービスの実装が必要です：
1. 注文の作成、更新、キャンセルの機能
2. 在庫チェックとの連携
3. 支払い処理との統合
4. トランザクション管理

# 期待される出力
1. サービスクラスの実装
2. 必要なインターフェースの定義
3. ユニットテストのサンプル
```

### コンテキスト提供のベストプラクティス

1. **階層的な構造化**
   - 一般的な情報から具体的な情報へ
   - 優先順位に基づく情報の配置
   - 関連する制約のグループ化

2. **具体的な制約の明示**
   - バージョン番号の明記
   - 命名規則の具体例
   - パフォーマンス要件の数値化

3. **参照情報の提供**
   - 既存のコードスニペット
   - 設計ドキュメントのリンク
   - APIの仕様書

## 実装例

プロジェクトのコンテキストを効果的に提供した場合の実装例を示します：
- [レシピ1-2: コンテキストを考慮した実装例](https://github.com/t2k2pp/LLMPromptCookBook/blob/main/chapter%201/chapter%201-2/recipe1-2-code.ts)
- [注文処理フロー](https://github.com/t2k2pp/LLMPromptCookBook/blob/main/chapter%201/chapter%201-2/recipe1-2-flow.mermaid)

## 実行結果の分析

適切なコンテキスト提供により、以下の利点が得られました：

1. **アーキテクチャの一貫性**
   - クリーンアーキテクチャの原則に従った実装
   - 明確な依存性の方向
   - ドメイン駆動設計の原則の反映

2. **コーディング規約の遵守**
   - インターフェース命名規則の統一
   - 依存性注入パターンの適用
   - 一貫したエラーハンドリング

3. **テスト容易性**
   - モジュール化された設計
   - 明確な依存関係
   - テスタブルなコード構造

## 改善ポイント

1. **コンテキストの粒度**
   - より詳細なビジネスルール
   - エラーケースの具体例
   - パフォーマンス要件の定量化

2. **技術的な制約**
   - メモリ使用量の制限
   - レスポンスタイムの要件
   - スケーラビリティ要件

3. **運用面の考慮**
   - モニタリング要件
   - ログ出力要件
   - デバッグ情報

## ベストプラクティス

1. **コンテキストの優先順位付け**
   - 重要度に基づく情報の配置
   - 必須要件と任意要件の区別
   - 制約条件の明確な分類

2. **再利用可能なコンテキスト**
   - プロジェクトテンプレートの作成
   - 共通制約のライブラリ化
   - コンテキストの版数管理

3. **コンテキストの検証**
   - レビュープロセスの確立
   - チェックリストの活用
   - 自動検証ツールの導入

## 関連レシピ

- レシピ1-1: プロンプトの基本構造と設計原則
- レシピ1-3: 制約条件の明示的な指定
- レシピ2-2: APIエンドポイントの実装

## Tips

- コンテキストは定期的に見直し、更新する
- プロジェクト固有の制約を明確に文書化する
- チーム内でコンテキストテンプレートを共有する

## Warning

- 過度に詳細なコンテキストは避ける
- 矛盾する制約を含めない
- セキュリティに関する情報は慎重に扱う
