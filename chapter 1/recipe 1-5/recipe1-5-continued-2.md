## エッジケース対策のベストプラクティス（続き）

4. **監視とログ**
   - 詳細なエラーログ
   - メトリクスの収集
   - アラート設定

5. **テスト戦略**
   - ユニットテスト
   - 統合テスト
   - カオスエンジニアリング

## プロンプトでのエッジケース指定パターン

### 1. チェックリスト方式
```
以下のエッジケースに対する処理を実装してください：

データ検証:
- [ ] 空の入力値
- [ ] 最大長超過
- [ ] 不正な文字

エラー処理:
- [ ] DB接続エラー
- [ ] 外部APIタイムアウト
- [ ] 並行処理の競合

リソース管理:
- [ ] メモリ使用量の制限
- [ ] コネクションプーリング
- [ ] バッファサイズの制御
```

### 2. シナリオベース方式
```
以下のシナリオを考慮した実装を行ってください：

シナリオ1: 高負荷時の動作
- 同時リクエスト数が急増
- DBコネクションの枯渇
- キャッシュの高負荷

シナリオ2: ネットワーク障害
- 断続的な接続エラー
- 応答遅延
- 部分的なタイムアウト

シナリオ3: データ異常
- 破損したデータ
- 不整合な状態
- バージョン競合
```

### 3. 制約ベース方式
```
以下の制約を満たすように実装してください：

性能要件:
- レイテンシ: 99%tile < 100ms
- スループット: 1000 req/sec
- メモリ使用量: < 512MB

耐障害性:
- 自動リトライ
- フォールバック処理
- グレースフルデグラデーション

セキュリティ:
- 入力検証
- レート制限
- エラー情報の制御
```

## Tips

1. **エッジケースの優先順位付け**
   - 発生頻度の評価
   - ビジネスインパクトの考慮
   - 対応コストの試算

2. **段階的な対応**
   - クリティカルな問題から対応
   - モニタリングの強化
   - フィードバックループの確立

3. **ドキュメント化**
   - エッジケースの一覧化
   - 対応方針の明確化
   - レビュー基準の設定

## Warning

- すべてのエッジケースを完璧に処理しようとしない
- 過度な防御的プログラミングを避ける
- ビジネス要件とのバランスを取る

## 関連レシピ
- レシピ1-3: 制約条件の明示的な指定
- レシピ1-6: 出力フォーマットの制御
- レシピ2-2: APIエンドポイントの実装

## まとめ

エッジケースへの対応は、以下の点に注意して進めることが重要です：

1. 体系的なエッジケースの洗い出し
2. 優先順位に基づく対応計画
3. 適切なエラー処理の実装
4. 継続的なモニタリングと改善

プロンプトでエッジケースを指定する際は、具体的なシナリオや制約を明確に示し、期待する動作を詳細に説明することで、より適切な実装を得ることができます。